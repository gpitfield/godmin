<!DOCTYPE html>
<html>
<head>
<!-- Standard Meta -->
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

{{template "admin/bootstrap.html"}}

<!-- Site Properities -->
<title>{{.brand}}</title>

</head>
  <body>

    <div class="container">

    {{ template "admin/navbar.html" .}}
    {{ $values := .results}}
    {{ $modelAdmin := .modelAdmin}}
      <div>
        <form id="record-set" method="post">
          <div style="display:inline-block;margin-bottom:10px;">
            {{if $modelAdmin.ListActions}}
              <select class="form-control" name="action">
              <option value="">Actions</option>
            {{else}}
              <select class="form-control" disabled>
              <option value="">No Actions Defined</option>
            {{end}}
              {{range $action := $modelAdmin.ListActions}}
                <option value="{{$action.Identifier}}">{{$action.DisplayName}}</option>
              {{end}}
            </select>
          </div>
          {{if $modelAdmin.ListActions}}
            <button type="submit" class="btn btn-default">Go</button>
          {{else}}
            <button type="submit" class="btn btn-default" disabled="disabled">Go</button>
          {{end}}
          <table class="table table-striped well" id="list-table">
            <th>
              <input type="checkbox" id="selectAll">
            </th>
            {{range .modelAdmin.ListFields}}
              <th>{{.}}</th>
            {{end}}
            {{range $position, $row := $values}}
              <tr>
                <td><input type="checkbox" name="ids" class="rowCheck" value="{{index $.pks $position}}"></td>
                {{range $index, $field := $modelAdmin.ListFields}}
                  <td>
                    {{ if eq $index 0}}<a href="{{index $.pks $position}}">{{end}}
                    {{index $row $field}}
                    {{ if eq $index 0}}</a>{{end}}                  
                  </td>
                {{end}}
              </tr>
            {{end}}
          </table>
        </form>
      </div>
    <nav>
      {{ template "admin/paginator.html" .}}
    </nav>
    </div> <!-- /container -->
    <script type="text/javascript">
      var checkedIDs = [];
      function updateCheckedIds () {
        checkedIDs = []        
        $("#list-table").find("input:checked").each(function(index){
          if ($(this).hasClass("rowCheck")) {
            checkedIDs.push($(this).attr("id"));
          }
        });
      }

      function confirmDelete() {
        if (confirm("Are you sure you want to delete the selected records?")) {

        }

      }
      $(document).ready(function(){
        $("#action-delete").click(function(){
          confirmDelete();
        });

        $("#selectAll").change(function(){
          if ($(this).is(":checked")) {
            $(":checkbox").prop("checked", true);
          } else {
            $(":checkbox").prop("checked", false);
          }
          updateCheckedIds();
        });

        $(".rowCheck").change(function(){
          if (! $(this).is(":checked")) {
            $("#selectAll").prop("checked", false);            
          }
          updateCheckedIds();
        });


      });
    </script>
  </body>
  </html>